<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Checkout — Edunancial</title>
<style>
  :root { --red:#c8102e; --ink:#111; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:#fff}
  header{background:var(--red);color:#000;font-weight:800;text-align:center;padding:14px 10px;letter-spacing:.4px}
  main{max-width:720px;margin:24px auto 56px;padding:0 16px}
  .card{border:1px solid #e6e6ea;border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(0,0,0,.04)}
  h1{font-size:22px;margin:0 0 10px}
  .sku{color:#555;margin:0 0 16px}
  label{display:block;margin:12px 0 6px;font-weight:700}
  input[type="text"]{width:100%;padding:10px 12px;border:1px solid #cfcfd6;border-radius:8px;font-size:16px}
  .inline{display:flex;align-items:center;gap:10px}
  .inline input[type="checkbox"]{width:20px;height:20px}
  .rows{margin-top:10px}
  .row{display:flex;justify-content:space-between;margin:6px 0}
  .total{font-weight:900;font-size:22px;margin-top:10px}
  .muted{color:#666;font-size:14px}
  .btn{display:inline-block;background:#0b2e4f;color:#fff;padding:12px 16px;border-radius:8px;text-decoration:none;border:0;font-weight:800}
  .btn:disabled{opacity:.5}
  .agree{margin-top:14px;font-size:13px;color:#444}
  .agree a{color:#0b2e4f;text-decoration:underline}
  .note{background:#fffbeb;border:1px solid #f1e1a6;color:#7a5a00;border-radius:8px;padding:.75rem;margin-top:1rem}
</style>
</head>
<body>
<header>EDUNANCIAL CHECKOUT</header>

<main>
  <div class="card">
    <h1>Mini Course: Edunancial Method</h1>
    <p class="sku">SKU: <strong>EDN-MINI-EM-001</strong></p>

    <div class="inline">
      <input type="checkbox" id="under18" />
      <label for="under18" style="margin:0">I am under 18</label>
    </div>

    <label for="code">Discount / Under-18 Code</label>
    <input id="code" type="text" placeholder="Enter code (PR12345$$ for your $1 test)" inputmode="text" autocomplete="off" />

    <div class="rows">
      <div class="row"><span>Subtotal</span>     <span id="subtotal">$75.00</span></div>
      <div class="row"><span>Early-bird</span>    <span id="earlybird">-$11.25</span></div>
      <div class="row"><span>Under-18 code</span> <span id="u18line">-$0.00</span></div>
      <div class="row total"><span>Total</span>   <span id="total">$63.75</span></div>
    </div>

    <p class="agree">By paying you agree to our <a href="/terms.html">Terms</a> and <a href="/refunds.html">Refunds</a>.</p>

    <!-- PayPal Standard form (no external JS) -->
    <form id="ppStandard" action="https://www.paypal.com/cgi-bin/webscr" method="post">
      <!-- REQUIRED: Replace value below with YOUR PayPal Business email OR Merchant ID -->
      <input type="hidden" name="business" id="ppBusiness" value="YOUR-PAYPAL-BUSINESS-EMAIL-OR-MERCHANT-ID" />

      <!-- Single-item purchase -->
      <input type="hidden" name="cmd" value="_xclick" />
      <input type="hidden" name="item_name" value="Mini Course: Edunancial Method (EN)" />
      <input type="hidden" name="item_number" value="EDN-MINI-EM-001" />
      <input type="hidden" name="currency_code" value="USD" />
      <input type="hidden" name="amount" id="ppAmount" value="63.75" />
      <!-- Optional fields -->
      <input type="hidden" name="no_shipping" value="1" />
      <input type="hidden" name="no_note" value="1" />
      <!-- Return URLs -->
      <input type="hidden" name="return" value="https://www.edunancial.com/thank-you.html" />
      <input type="hidden" name="cancel_return" value="https://www.edunancial.com/checkout.html" />
      <!-- Custom meta (we pass whether code was used) -->
      <input type="hidden" name="custom" id="ppCustom" value="" />

      <button type="submit" class="btn" id="payBtn">Pay with PayPal</button>
    </form>

    <div class="note">
      If the PayPal app opens or you’re redirected to paypal.com, that’s expected.  
      This method avoids ad-blocker issues and works on most phones/Wi-Fi.
    </div>
  </div>
</main>

<script>
  // ----- Pricing settings -----
  const SUBTOTAL = 75.00;
  const EARLY_BIRD_RATE = 0.15; // 15%
  const EARLY_DEADLINE = new Date('2025-09-26T23:59:59-05:00');
  const TEST_CODE = 'PR12345$$';

  const $u18 = document.getElementById('under18');
  const $code = document.getElementById('code');
  const $u18line = document.getElementById('u18line');
  const $subtotal = document.getElementById('subtotal');
  const $earlybird = document.getElementById('earlybird');
  const $total = document.getElementById('total');
  const $amount = document.getElementById('ppAmount');
  const $custom = document.getElementById('ppCustom');
  const $btn = document.getElementById('payBtn');

  function fmt(n){ return '$' + Number(n).toFixed(2); }

  function calc() {
    const early = (new Date() <= EARLY_DEADLINE) ? SUBTOTAL * EARLY_BIRD_RATE : 0;
    let u18disc = 0;
    let total = SUBTOTAL - early;

    if ($u18.checked && $code.value.trim() === TEST_CODE) {
      // Drive total to exactly $1.00
      u18disc = Math.max(0, total - 1.00);
      total = 1.00;
    }

    // Update UI
    $subtotal.textContent = fmt(SUBTOTAL);
    $earlybird.textContent = '-' + fmt(early).slice(1);
    $u18line.textContent = '-' + fmt(u18disc).slice(1);
    $total.textContent = fmt(total);

    // Update PayPal Standard form fields
    $amount.value = total.toFixed(2);         // amount submitted to PayPal
    $custom.value = JSON.stringify({
      under18: $u18.checked,
      codeUsed: ($code.value.trim() === TEST_CODE),
      ts: Date.now()
    });

    // Guard: PayPal requires > 0.00
    $btn.disabled = total <= 0;
  }

  ['change','keyup'].forEach(ev => {
    $u18.addEventListener(ev, calc);
    $code.addEventListener(ev, calc);
  });

  // initial
  calc();
</script>
</body>
</html>
