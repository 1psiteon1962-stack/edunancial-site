<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Pagar — Edunancial</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div id="sitebar"></div><script src="/header.js"></script>

  <main class="container">
    <section class="card">
      <h1>Pago</h1>
      <p class="sku" id="sku">SKU: (cargando…)</p>

      <div style="display:flex; gap:18px; align-items:center; flex-wrap:wrap">
        <label><input type="checkbox" id="u18"> Soy menor de 18</label>
        <label> Código de Descuento / Menor de 18:
          <input id="code" type="text" placeholder="opcional" style="padding:8px;border-radius:8px;border:1px solid #ccc">
        </label>
      </div>

      <p>Total: <span class="price" id="total">$0.00</span> <span id="badge" style="font-weight:800;color:#0a0"></span></p>

      <a id="go" class="btn btn-primary" href="#">Continuar a PayPal</a>
      <p style="margin-top:8px; color:#666">Al pagar aceptas nuestros <a href="/es-terms.html">Términos</a> y <a href="/es-refunds.html">Reembolsos</a>.</p>
    </section>
  </main>

  <script>
    const q = new URLSearchParams(location.search);
    const basePrice = parseFloat(q.get('price') || '0');
    const sku = q.get('sku') || 'EDN-ITEM';
    document.getElementById('sku').textContent = 'SKU: ' + sku;

    const codeEl = document.getElementById('code');
    const u18El = document.getElementById('u18');
    const totalEl = document.getElementById('total');
    const badgeEl = document.getElementById('badge');
    const go = document.getElementById('go');

    function calc(){
      const tieneDescuento = u18El.checked || (codeEl.value || '').trim() === 'PR12345$$';
      const total = tieneDescuento ? 3.00 : basePrice;

      totalEl.textContent = '$' + total.toFixed(2);
      badgeEl.textContent = tieneDescuento ? 'tarifa de prueba aplicada' : '';

      const paypalLink = '/es-payments.html?sku=' + encodeURIComponent(sku) + '&amount=' + total.toFixed(2);
      go.href = paypalLink;
    }
    u18El.addEventListener('change', calc);
    codeEl.addEventListener('input', calc);
    calc();
  </script>
</body>
</html>
