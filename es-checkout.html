<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pago — Edunancial</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div id="sitebar"></div>
  <script src="/header.js"></script>

  <main class="container">
    <section class="card">
      <h1>Pago</h1>
      <p><strong>SKU:</strong> <span id="sku">EDN-CRS-MIX-001</span></p>

      <form id="payForm" class="stack" method="GET" action="#">
        <fieldset class="row">
          <legend class="label">Grupo de edad</legend>
          <label class="radio"><input type="radio" name="age" value="adult"> 18 o más</label>
          <label class="radio"><input type="radio" name="age" value="under"> Menor de 18</label>
        </fieldset>

        <div class="row">
          <label for="agecode" class="label">Código de descuento / menor de 18</label>
          <input id="agecode" name="agecode" type="text" inputmode="text" autocomplete="off" placeholder="Escriba el código" class="input" />
        </div>

        <p class="muted">Precio:</p>
        <p class="price"><span id="currency">$</span><span id="amount" data-base="75.00">75.00</span></p>

        <button type="submit" class="btn btn-primary">Continuar a PayPal</button>
        <p id="msg" class="tiny muted"></p>

        <p class="tiny muted">
          Al pagar acepta nuestros <a href="/es-terms.html">Términos</a> y <a href="/es-refunds.html">Reembolsos</a>.
        </p>
      </form>
    </section>
  </main>

  <footer class="container tiny muted">© 2025 Edunancial, Inc.</footer>

  <script>
  (function () {
    // ====== PEGAR AQUÍ SU ENLACE DE PAYPAL (formato “Pay Now”) ======
    var PAYPAL_BASE = ""; // ej.: https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=su%40correo.com&item_name=EDN-CRS-MIX-001&currency_code=USD&no_shipping=1

    var form=document.getElementById('payForm');
    var amountEl=document.getElementById('amount');
    var codeEl=document.getElementById('agecode');
    var msgEl=document.getElementById('msg');

    function base(){ var b=parseFloat(amountEl.dataset.base||'0'); return isFinite(b)?b:0; }
    function setAmount(v){ amountEl.textContent = Number(v).toFixed(2); }
    function age(){ var r=form.querySelector('input[name="age"]:checked'); return r?r.value:''; }
    function elegible(){ return age()==='under' && (codeEl.value||'').trim().length>0; }
    function compute(){ return elegible()?3.00:base(); }

    function validar(){
      var ok=true; msgEl.textContent='';
      if(!age()){ ok=false; msgEl.textContent='Seleccione un grupo de edad.'; }
      else if(age()==='under' && (codeEl.value||'').trim().length===0){ ok=false; msgEl.textContent='Ingrese el código de menor de 18.'; }
      setAmount(compute());
      return ok;
    }

    form.addEventListener('input', validar);
    form.addEventListener('change', validar);
    validar();

    form.addEventListener('submit', function(e){
      if(!validar()){ e.preventDefault(); return; }
      if(!PAYPAL_BASE){ e.preventDefault(); alert('Agregue su enlace de PayPal en PAYPAL_BASE en es-checkout.html'); return; }
      try{
        var u=new URL(PAYPAL_BASE);
        u.searchParams.set('amount', Number(compute()).toFixed(2));
        u.searchParams.set('return', location.origin + '/es-thank-you.html');
        u.searchParams.set('cancel_return', location.origin + '/es-checkout.html');
        form.action=u.toString();
      }catch(err){
        form.action=PAYPAL_BASE;
      }
    });
  })();
  </script>
</body>
</html>
