<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pago — Edunancial</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .section { margin-bottom: 20px; }
    label { margin-right: 10px; }
    input[type="text"] { width: 250px; padding: 5px; }
    #price { font-weight: bold; margin-top: 10px; }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Pago</h2>
  <form id="checkout-form">
    <div class="section">
      <p>Seleccione su grupo de edad:</p>
      <label><input type="radio" id="age18" name="age" value="18+"> 18 años o más</label>
      <label><input type="radio" id="ageU18" name="age" value="u18"> Menor de 18</label>
    </div>

    <div class="section">
      <p>Código de Descuento / Menor de 18:</p>
      <input id="code" type="text" placeholder="Ingrese su código">
    </div>

    <div id="price" class="section">$75.00</div>

    <button id="payBtn" type="button">Continuar a PayPal</button>
  </form>

  <script>
  (() => {
    const PAYPAL_BASE = "https://www.paypal.com/ncp/payment/8RU4TQHFW88S8";
    const BASE_PRICE = 75.00;
    const DISCOUNT_PRICE = 3.00;
    const ACCEPTED_CODES = new Set(["PR12345$$$", "PR2345$$$"]);

    const priceEl = document.getElementById("price");
    const codeEl = document.getElementById("code");
    const age18El = document.getElementById("age18");
    const ageU18El = document.getElementById("ageU18");
    const payBtn = document.getElementById("payBtn");

    const format = (n) => n.toLocaleString("es-ES",{style:"currency",currency:"USD"});
    const amountParam = (n) => `amount=${encodeURIComponent(n.toFixed(2))}`;

    function currentAmount() {
      const pickedAge = age18El.checked || ageU18El.checked;
      const code = (codeEl.value || "").trim();
      if (!pickedAge || !code) return BASE_PRICE;
      if (ACCEPTED_CODES.has(code)) return DISCOUNT_PRICE;
      return BASE_PRICE;
    }

    function renderPrice() { priceEl.textContent = format(currentAmount()); }
    [age18El, ageU18El, codeEl].forEach(el => {
      el && el.addEventListener("change", renderPrice);
      el && el.addEventListener("input", renderPrice);
    });
    renderPrice();

    payBtn.addEventListener("click", (e) => {
      e.preventDefault();
      const pickedAge = age18El.checked || ageU18El.checked;
      const code = (codeEl.value || "").trim();
      if (!pickedAge) { alert("Por favor seleccione un grupo de edad."); return; }
      if (!code) { alert("Por favor ingrese su código."); return; }
      if (!ACCEPTED_CODES.has(code)) { alert("Código no reconocido."); return; }
      const amt = currentAmount();
      window.location.href = `${PAYPAL_BASE}?${amountParam(amt)}`;
    });
  })();
  </script>
</body>
</html>
